<!DOCTYPE html>

<script type="text/javascript" src="jquery-3.4.1.min.js"></script>

<script>
	function test_ip(ip, status){
		this.status = 0;
		
		
		//var promise = $.ajax({ timeout: 1000 });


		var t = setTimeout(function(){
			$.ajax({ url: ip, success: function(data){
				//Update your dashboard gauge
				
				//Setup the next poll recursively
				//poll();
			  }, dataType: "json",
			  error: function(jqXHR, textStatus, errorThrown) 
				{
					console.log(t);
					console.log(textStatus, errorThrown);
					if(textStatus==="timeout") console.log("does not exist");//do something on timeout
					else console.log("it is alive");
				} 
			});
		}, 300);
		console.log(ip, t);
	  
	 // promise.fail(function(jqXHR, textStatus) {
   // if(textStatus==="timeout") {
        // handle timeout  
   // }
	};
	  
	function test_ip_two(ip, status, timeout){
		this.status = 0;
		$.ajax({ 
			url: ip,//"https://"+ip, 
			error: function(request, error){
				this.status = 1;
				console.log("BEGIN ",ip,this.status," END");
			},
			dataType: "json",
			timeout: 30000});
		
		
		
	};

	/*function testtwo(){
		var ping = new Date;

		$.ajax({
			url: "https://192.168.1.98",
			cache:false,
			success: function(output){ 
				ping = new Date - ping;
				Console.log("Ping/Latency: " + ping);
				}
		});
	  };*/
</script>	

<HTML lang="en">
	<HEAD>
		<TITLE>SiteMap IP Health</TITLE>
	</HEAD>
	<BODY>
		<P id="IP_Status">NULL</P>
	</BODY>

	<script> 
		let f = 4;
		var callback = 0;
		console.log("Begin");
		//poll();
			
		var status = -1;
		var timeout = 300;
		//var ip = "https://192.168.1.98";test_ip(ip, status); console.log(status);
		//var ip = "https://192.168.1.1";test_ip(ip, status); console.log(status);
		//var ip = "https://127.0.0.1";test_ip(ip, status); console.log(status);
		//var ip = "https://192.168.1.101";test_ip(ip, status); console.log(status);
		
		var ip = "https://192.168.1.98";test_ip_two(ip, status, timeout); //console.log(ip, status);
		var ipone = "https://192.168.1.1";test_ip_two(ipone, status, timeout); //console.log(ip, status);
		var iptwo = "https://127.0.0.1";test_ip_two(iptwo, status, timeout); //console.log(ip, status);
		var ip3 = "https://192.168.1.101";test_ip_two(ip3, status, timeout); //console.log(ip, status);
		
		console.log("End");
		/*var a = new XMLHttpRequest();
		a.onreadystatechange = function () {

			if (a.readyState === a.HEADERS_RECEIVED) {
				a.abort();
				console.log(new Date - abc);
			}
		};

		var abc = new Date;

		a.open("GET", "https://192.168.1.92");
		a.send(null);
		console.log("END TWO");*/

		
		
	</script>
	<noscript>Current settings do not support JavaScript.</noscript>
</HTML>
